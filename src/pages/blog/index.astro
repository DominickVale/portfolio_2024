---
import StatusItem from '../../components/StatusItem.astro'
import Layout from '../../layouts/Layout.astro'
import BlogEntry from '../../components/blog/BlogEntry.astro'
import { getCollection } from 'astro:content'
import NextPageBtn from '../../components/NextPageBtn.astro'

const lastUpdated = new Date().toLocaleDateString('en-GB')
const allPosts = await getCollection('blog')
---

<Layout title="Dominick Vale - â“’ 2024" data-menu-trigger="default" renderer="blog">
  <section id="blog-header" class="relative col-span-10 col-start-2">
    <div class="relative my-8 flex h-max flex-col sm:my-0 sm:flex-row">
      <h1
        class="mt-[2vh] font-display text-[15vw] font-black leading-[100%] md:text-8xl lg:text-[calc(5vw+6.2vh)] tall:mt-[6vh] taller:mt-[10vh]"
        data-aberration="0.8"
      >
        BLOG
      </h1>
      <div
        id="blog-blurred-bg"
        class="bg bg-blur cut-corner absolute bottom-[-5.5vh] left-[-62%] z-[-1] hidden h-1/2 w-[55rem] sm:block md:w-[60rem] lg:w-[70rem] xl:w-full"
      >
      </div>
      <div class="ml-1 mr-auto mt-2 gap-[7%] self-end sm:mb-6 sm:ml-4 lg:ml-6">
        <ul id="blog-status">
          <StatusItem filled class="text-xxs md:text-xs">UPDATED:&nbsp;{lastUpdated}</StatusItem>
          <StatusItem filled class="text-xxs md:text-xs">PROJ. CASES: 3</StatusItem>
        </ul>
      </div>
    </div>
    <h2 class="mb-3 ml-3 hidden min-h-6 whitespace-nowrap font-mono text-xs font-black tracking-button text-inactive sm:block tall:text-base">
      UNCOORDINATED THOUGHTS AND PROJECT CASES
    </h2>
  </section>

  <section
    class="posts-container max-w-screen no-scrollbar col-span-10 col-start-2 row-start-2 flex max-h-[70vh] min-h-28 flex-col items-center pb-24 pt-3 sm:col-span-12 sm:col-start-1 sm:max-h-none sm:flex-row sm:items-start sm:overflow-x-scroll sm:px-[8vw] sm:pb-0"
  >
    {
      allPosts.map((post, i) => (
        <a id={`${i}`} class="blog-article my-[4vh] sm:mx-[2vw] sm:my-0 xl:mx-[3rem]" href={`/blog/${post.slug}`}>
          <BlogEntry {...post.data} />
        </a>
      ))
    }
  </section>

  <div class="col-span-1 col-start-12 mb-14 ml-2 hidden h-full items-center sm:flex">
    <NextPageBtn href="/contact">???</NextPageBtn>
  </div>
</Layout>

<style is:global>
  .cut-corner {
    clip-path: polygon(100% 0, 100% 45%, 96% 100%, 0 100%, 0 0);
  }
  .posts-container::before {
    @apply sm:hidden;
    @apply bottom-12;
    content: '';
    position: absolute;
    left: 0;
    width: 100%;
    height: 10%;
    background: linear-gradient(0deg, rgba(17, 16, 16, 1) 0%, rgba(17, 16, 16, 0.1) 100%);
    pointer-events: none;
    z-index: 1;
  }
  @screen sm {
    .posts-container {
      mask-image: unset;
    }
  }

  .blog-article {
    .marquee,
    .marquee-tag,
    .marquee-dot {
      transition: all 0.05s ease-in;
    }
  }

  .blog-article:hover,
  .blog-article.active {
    .marquee {
      background-color: white;
    }
    .marquee-tag {
      color: var(--bg-dark);
    }
    .marquee-dot {
      background-color: var(--bg-dark);
    }
  }

  .blog-article.active .marquee > span,
  .blog-article:hover .marquee > span,
  .blog-article:focus .marquee > span {
    animation: marquee 30s infinite linear;
  }
</style>
